@startuml levelmusic_diagram
'-----------------------------
' Entities
'-----------------------------

entity user #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * auth_id : STRING
  * email: STRING
  * password: STRING
  * full_name: STRING
  * phone: STRING
  * document_type: ENUM('DNI', 'RUC') (nullable)
  * document_number: STRING (nullable)
  * role: ENUM
  * status: ENUM('Activo', 'Inactivo')
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity event_type #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * type : STRING
  * description : STRING
  * category : ENUM
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity event #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * name : STRING
  * description : STRING
  * date : DATETIME
  * time_range : STRING
  * attendees_count : INTEGER
  * exact_address : STRING
  * location_reference : STRING
  * place_type : ENUM('Abierto', 'Cerrado')
  * place_size : INTEGER
  * user_id : OBJECT ID
  * event_type_id : OBJECT ID
  * status: ENUM('Pendiente', 'Enviado', 'Confirmado', 'Terminado', 'Cancelado')
  * final_price : DECIMAL(10,2)
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity service_type #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * name : STRING ' Ej: Comida, Fotografía, Toldos
  * description : STRING
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity provider #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * name : STRING ' Nombre del proveedor
  * contact_name : STRING
  * phone : STRING
  * email : STRING
  * status : ENUM('Activo', 'Inactivo')
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity service #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * name : STRING
  * description : STRING
  * price : DECIMAL (nullable)
  * status: ENUM('Activo', 'Inactivo')
  * provider_id : OBJECT ID
  * service_type_id : OBJECT ID
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity service_detail #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * service_id : OBJECT ID
  * name : STRING
  * description : STRING
  * price : DECIMAL
  * multimedia : ARRAY
  * status : ENUM('Activo', 'Inactivo')
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity event_service #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * event_id : OBJECT ID
  * service_id : OBJECT ID
}

entity worker_type #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * name : STRING
  * description : STRING
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity worker #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * worker_type_id : OBJECT ID
  * availability : BOOLEAN
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity event_worker #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * event_id : OBJECT ID
  * worker_id : OBJECT ID
  * status: ENUM('Pendiente', 'Cumplido', 'No Cumplido')
  * notes : STRING
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity equipment #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * name : STRING
  * description : STRING
  * equipment_type: ENUM('Sonido', 'Iluminación', 'Otros') 
  * serial_number: STRING
  * status: ENUM('Disponible', 'En Uso', 'En Mantenimiento', 'Daniado')
  * location: ENUM('Almacén', 'Evento', 'Mantenimiento')
  * last_maintenance: DATETIME
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity equipment_maintenance #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * equipment_id : OBJECT ID
  * maintenance_type: ENUM('Preventivo', 'Correctivo')
  * description : STRING
  * date : DATETIME
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity storehouse_movement #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * equipment_id : OBJECT ID
  * event_id : OBJECT ID
  * movement_type: ENUM('Salida', 'Entrada')
  * movement_date : DATETIME
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity activity_template #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * event_type_id : OBJECT ID
  * title : STRING
  * description : STRING
  * phase : ENUM('pre_evento', 'durante_evento', 'post_evento')
  * is_mandatory : BOOLEAN
  * order : INTEGER
  --
  created_at : DATETIME
  updated_at : DATETIME
}

entity event_activity #E6BB93 {
  * _id : OBJECT ID <<UID>>
  * event_id : OBJECT ID
  * title : STRING
  * description : STRING
  * phase : ENUM('pre_evento', 'durante_evento', 'post_evento')
  * status : ENUM('pendiente', 'realizada', 'validada', 'rechazada')
  * admin_notes : STRING
  * evidencia_url : STRING
  * realizada_at : DATETIME
  --
  created_at : DATETIME
  updated_at : DATETIME
}

'-----------------------------
' Relationships
'-----------------------------

user ||--o{ event : "crea"
event_type ||--o{ event : "clasifica"
event ||--o{ event_service : "tiene"
service ||--o{ event_service : "se usa"
service_type ||--o{ service : "clasifica"
provider ||--o{ service : "provee"
service ||--o{ service_detail : "tiene opciones"
worker_type ||--o{ worker : "clasifica"
event ||--o{ event_worker : "asigna"
worker ||--o{ event_worker : "participa"
event ||--o{ storehouse_movement : "asocia"
equipment ||--o{ storehouse_movement : "se mueve"
equipment ||--o{ equipment_maintenance : "recibe mantenimiento"
event_type ||--o{ activity_template : "usa plantilla"
event ||--o{ event_activity : "genera checklist"

@enduml
